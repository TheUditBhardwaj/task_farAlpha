apiVersion: v1
kind: Pod
metadata:
  name: load-generator
spec:
  containers:
  - name: load-gen
    image: python:3.9-slim
    command: ["/bin/sh"]
    args:
      - -c
      - |
        pip install -q requests && python3 -c "
        import requests
        import time
        import threading
        
        url = 'http://flask-service:5000/data'
        print('Starting load generation on', url)
        
        def make_request():
            while True:
                try:
                    # Make both GET and POST requests for more load
                    requests.get(url, timeout=1)
                    requests.post(url, json={'load': 'test'}, timeout=1)
                except:
                    pass
        
        # Start 10 threads for parallel requests
        threads = []
        for i in range(10):
            t = threading.Thread(target=make_request)
            t.daemon = True
            t.start()
            threads.append(t)
        
        # Keep running
        while True:
            time.sleep(1)
        "
  restartPolicy: Never

